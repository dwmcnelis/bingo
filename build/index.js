!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";t.__esModule=!0;var o=r(1);t.logger=o.default},function(e,t,r){"use strict";t.__esModule=!0;var o=r(16)({level:"trace",prettyPrint:{colorize:!0,levelFirst:!0,translateTime:!0,ignore:"pid,hostname"}});t.default=o},function(e,t,r){"use strict";t.__esModule=!0;var o=r(17);t.json=o.default;var n=r(18);t.pdf=n.default;var i=r(22);t.zip=i.default},function(e,t,r){"use strict";t.__esModule=!0;var o=r(4),n=r(5),i=r(6),a=r(7),l=r(8),s=r(9),u=r(0),f=new o,c=process.env.PORT||3e3;f.use(n()),f.use(l());var d=new o;u.logger.debug("App at "+process.cwd()+"/server/app/build"),d.use(i(process.cwd()+"/server/app/build")),u.logger.info("Mount app on /"),f.use(a("/",d)),u.logger.info("Mount card on /api/cards"),f.use(s.cards.routes()).use(s.cards.allowedMethods()),f.listen(c,(function(){u.logger.info("Listening on http://localhost:"+c)}))},function(e,t){e.exports=require("koa")},function(e,t){e.exports=require("koa-bodyparser")},function(e,t){e.exports=require("koa-static")},function(e,t){e.exports=require("koa-mount")},function(e,t){e.exports=require("@koa/cors")},function(e,t,r){"use strict";t.__esModule=!0;var o=r(10);t.cards=o.cards},function(e,t,r){"use strict";t.__esModule=!0;var o=r(11);t.cards=o.default},function(e,t,r){"use strict";var o=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function l(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((o=o.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};t.__esModule=!0;var i=r(12),a=r(13),l=r(14),s=r(2),u=r(0),f=new i;f.get("/api/cards:suffix?",(function(e,t){return o(void 0,void 0,void 0,(function(){var t,r,o,i,f,c,d,p,g;return n(this,(function(n){if(t=(t=e.params.suffix)||".json",r=Object.entries(e.request.query).reduce((function(e,t){var r=t[0],o=t[1];return["numbers","groups"].includes(r)?e[r]=JSON.parse(o):["games","per"].includes(r)?e[r]=parseInt(o,10):e[r]=o,e}),{}),o=new l.Card(a.pick(r,["title","numbers"])),(i=o.validate()).valid){f=a.pick(r,["games","per","groups"]),c=f.games,d=f.per,p=f.groups,c=c||1,d=d||1,p=p||[{name:"untitled",players:1}],g=o.generate(c,d,p);try{".json"===t?(e.attachment("cards.json"),e.type="application/json; charset=utf-8",e.status=200,e.body=s.json.render(g)):".pdf"===t?(e.attachment("cards.pdf"),e.type="application/pdf",e.status=200,e.body=s.pdf.render(g)):".zip"===t?(e.attachment("cards.zip"),e.type="application/zip",e.status=200,e.body=s.zip.render(g)):(e.type="application/json; charset=utf-8",e.status=400,e.body={status:"error",message:"Type "+t+" unsupported"})}catch(e){u.logger.error("Error: "+e+" "+e.stack)}}else i.errors.forEach((function(e){return u.logger.error("Validation Error: "+e)})),e.type="application/json; charset=utf-8",e.status=400,e.body={status:"error",message:i.errors};return[2]}))}))})),t.default=f},function(e,t){e.exports=require("koa-router")},function(e,t){e.exports=require("lodash")},function(e,t,r){"use strict";t.__esModule=!0;var o=r(15);t.Card=o.default},function(e,t,r){"use strict";t.__esModule=!0;var o=r(1),n=function(){function e(e){void 0===e&&(e={});var t=e.title,r=e.numbers;this._title=t||"Bingo",this._numbers=r||[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],this._chunks=[];var o=this._numbers.length;if(o>=10&&o%5==0)for(var n=Math.floor(o/5),i=0,a=this._numbers.length;i<a;i+=n)this._chunks.push(this._numbers.slice(i,i+n))}return e.prototype._shuffle=function(){if(5===this._chunks.length)for(var e=0;e<5;e++)for(var t=this._chunks[e],r=t.length-1;r>0;r--){var o=Math.floor(Math.random()*(r+1)),n=t[r];t[r]=t[o],t[o]=n}},e.prototype._card=function(){if(5===this._chunks.length){this._shuffle();var e=this._chunks[0].slice(0,5),t=this._chunks[1].slice(0,5),r=this._chunks[2].slice(0,5);r[2]="Free";var o=this._chunks[3].slice(0,5),n=this._chunks[4].slice(0,5);return{title:this._title,B:e,I:t,N:r,G:o,O:n}}},e.prototype.validate=function(){var e=[],t=this._numbers.length;return t<10&&e.push("Two few numbers"),t%5>0&&e.push("Numbers not disable by five"),e.length?{valid:!1,errors:e}:{valid:!0}},e.prototype.generate=function(e,t,r){var o=this,n=(r.reduce((function(e,t){return e+=t.players}),0),[]);return r.forEach((function(t){for(var r=e*t.players,i={name:t.name,players:t.players,doublesided:t.doublesided,total:r},a=[],l=0;l<r;l++)a.push(o._card());i.cards=a,n.push(i)})),{games:e,per:t,groups:n}},e.prototype.debug=function(){o.default.debug("card: title: "+this._title),o.default.debug("card: numbers: "+JSON.stringify(this._numbers)),o.default.debug("card: chunks: "+JSON.stringify(this._chunks))},e}();t.default=n},function(e,t){e.exports=require("pino")},function(e,t,r){"use strict";t.__esModule=!0;t.default={render:function(e){return e}}},function(e,t,r){"use strict";t.__esModule=!0;var o=r(19),n=r(20),i=r(21),a={default:{customFonts:{"OpenSans-Light":n.join(i.get(),"fonts/OpenSans-Light.ttf"),"OpenSans-Regular":n.join(i.get(),"fonts/OpenSans-Regular.ttf"),"OpenSans-Bold":n.join(i.get(),"fonts/OpenSans-Bold.ttf"),"Roboto-Thin":n.join(i.get(),"fonts/Roboto-Thin.ttf"),"Roboto-Light":n.join(i.get(),"fonts/Roboto-Light.ttf"),"Roboto-Regular":n.join(i.get(),"fonts/Roboto-Regular.ttf"),"Roboto-Bold":n.join(i.get(),"fonts/Roboto-Bold.ttf")},marksStrokeColor:"#dddddd",cardStrokeColor:"#666666",titleFontFamily:"OpenSans-Regular",titlePadding:4,titleStrokeColor:"black",titleFillColor:"#efefef",headerFontFamily:"Roboto-Bold",headerPadding:4,headerStrokeColor:"white",headerFillColor:"#666666",headerBorderColor:"#666666",cellFontFamily:"Roboto-Light",cellStrokeColor:"black",cellFillColor:"none",cellBorderColor:"#666666",footerFontFamily:"Roboto-Regular",footerPadding:2,footerStrokeColor:"black",footerFillColor:"#efefef"}},l={1:{per:1,pageLayout:"landscape",pageWidth:792,pageHeight:612,marginTop:36,marginBottom:36,marginLeft:36,marginRight:36,marginCard:36,cardWidth:720,cardHeight:540,titleFontSize:42,headerFontSize:48,cellFontSize:48,footerFontSize:22},2:{per:2,pageLayout:"portrait",pageWidth:612,pageHeight:792,marginTop:36,marginBottom:36,marginLeft:36,marginRight:36,marginCard:36,cardWidth:540,cardHeight:342,titleFontSize:26,headerFontSize:32,cellFontSize:32,footerFontSize:16},4:{per:4,pageLayout:"landscape",pageWidth:792,pageHeight:612,marginTop:36,marginBottom:36,marginLeft:36,marginRight:36,marginCard:36,cardWidth:342,cardHeight:252,titleFontSize:18,headerFontSize:20,cellFontSize:20,footerFontSize:14},6:{per:6,pageLayout:"portrait",pageWidth:612,pageHeight:792,marginTop:36,marginBottom:36,marginLeft:36,marginRight:36,marginCard:36,cardWidth:252,cardHeight:216,titleFontSize:18,headerFontSize:16,cellFontSize:16,footerFontSize:12}},s={render:function(e){var t=e.games,r=e.per,n=e.groups;t=t||1,n=n||[{}];var i=l[r=r||1],s=a.default,u=new o({layout:i.pageLayout,margins:{top:i.marginTop,bottom:i.marginBottom,left:i.marginLeft,right:i.marginRight}});return function(e,t){Object.entries(t).forEach((function(t){var r=t[0],o=t[1];e.registerFont(r,o)}))}(u,s.customFonts),function(e,t,r,o,n,i){n.pageLayout,n.pageWidth,n.pageHeight;var a=n.marginTop,l=(n.marginBottom,n.marginLeft),s=(n.marginRight,n.marginCard),u=n.cardWidth,f=n.cardHeight,c=n.titleFontSize,d=n.headerFontSize,p=n.cellFontSize,g=n.footerFontSize,h=i.cardStrokeColor,m=i.titleFontFamily,v=i.titlePadding,b=i.titleStrokeColor,y=i.titleFillColor,S=i.headerFontFamily,_=i.headerPadding,F=i.headerStrokeColor,k=i.headerFillColor,z=i.headerBorderColor,C=i.cellFontFamily,T=i.cellStrokeColor,O=i.cellFillColor,w=(i.cellBorderColor,i.footerFontFamily),x=i.footerPadding,j=i.footerStrokeColor,M=i.footerFillColor;e.font(i.titleFontFamily).fontSize(c);var R=e.heightOfString("A")+2*v+2;e.font(i.headerFontFamily).fontSize(d);var P=e.heightOfString("A")+2*_+2;e.font(i.cellFontFamily).fontSize(p);e.heightOfString("A");e.font(i.footerFontFamily).fontSize(g);var L=e.heightOfString("A")+2*x+2;o.forEach((function(n,i){n.name;for(var v=n.players,_=(n.total,n.cards),x=0,B=0;B<v;B+=1){x=1;for(var q=0;q<t;q++){var E=_[B*t+q],W=q%r,H=void 0,N=void 0;1===r?(H=0,N=0):2===r?(H=0,N=W):4===r?(H=W%2,N=Math.floor(W/2)%2):6===r&&(H=W%2,N=Math.floor(W/2)%3);var A=l+H*u+H*s,G=a+N*f+N*s,J=A+u,I=G+f,V=u/5,X=(f-R-L)/6;P=X,e.moveTo(A,G).lineTo(J,G).lineTo(J,I).lineTo(A,I).lineTo(A,G).lineWidth(1).stroke(h),e.moveTo(A,G+R).lineTo(J,G+R).stroke(h),e.moveTo(A,G+R+P).lineTo(J,G+R+P).stroke(h),e.moveTo(A,I-L).lineTo(J,I-L).stroke(h);for(var D=1;D<5;D++)e.moveTo(A+D*V,G+R).lineTo(A+D*V,G+R+P).stroke(z);for(D=1;D<5;D++)e.moveTo(A,G+R+P+D*X).lineTo(J,G+R+P+D*X).stroke(h);for(D=1;D<5;D++)e.moveTo(A+D*V,G+R+P).lineTo(A+D*V,I-L).stroke(h);var K=E.title,Q=A+1,U=G+1,Y=R-2,Z=u-2,$={width:Z,align:"center"};"none"!==y&&e.rect(Q,U,Z,Y).fill(y),e.font(m).fontSize(c).fillColor(b).text(K,Q,U+.5*(Y-e.heightOfString(K,$)),$),K=n.name+" Player"+(B+1)+" - Game"+(q+1),Q=A+1,U=I+1-L,Y=L-2,$={width:Z=u-2,align:"center"},"none"!==M&&e.rect(Q,U,Z,Y).fill(M),e.font(w).fontSize(g).fillColor(j).text(K,Q,U+.5*(Y-e.heightOfString(K,$)),$);var ee=Object.keys(E).filter((function(e){return"title"!==e}));e.font(S).fontSize(d);for(D=0;D<5;D++){var te=ee[D],re=A+1+D*V,oe=G+1+R,ne=P-2,ie=V-2,ae={width:ie,align:"center"};"none"!==k&&e.rect(re,oe,ie,ne).fill(k).fillColor(z).stroke(z),e.fillColor(F).text(te,re,oe+.5*(ne-e.heightOfString(te,ae)),ae)}e.font(C).fontSize(p);var le=.5*(X-e.heightOfString("X"));for(D=0;D<5;D++)for(var se=G+1+R+P+D*X,ue=X-2,fe=V-2,ce=0;ce<5;ce++){var de=E[ee[ce]][D],pe=A+1+ce*V,ge=se,he={width:fe,align:"center"};"none"!==O&&e.rect(pe,ge,fe,ue).fill(O),e.fillColor(T).text(de,pe,ge+le,he)}W===r-1&&q<t-1&&(e.addPage(),x+=1)}n.doublesided&&x%2>0&&e.addPage(),B<v-1&&e.addPage()}i<o.length-1&&e.addPage()}))}(u,t,r,n,i,s),u.end(),u}};t.default=s},function(e,t){e.exports=require("pdfkit")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("app-root-dir")},function(e,t,r){"use strict";t.__esModule=!0;var o=r(23),n=r(2),i=r(0),a={render:function(e){var t=o("zip",{zlib:{level:9}});t.on("warning",(function(e){if("ENOENT"!==e.code)throw e;i.logger.error("Error: "+e+" "+e.stack)})),t.on("error",(function(e){throw e}));var r=e.games,a=e.per,l=e.groups;return r=r||1,a=a||1,(l=l||[]).forEach((function(e){t.append(n.pdf.render({games:r,per:a,groups:[e]}),{name:e.name+".pdf"})})),t.finalize(),t}};t.default=a},function(e,t){e.exports=require("archiver")}]);